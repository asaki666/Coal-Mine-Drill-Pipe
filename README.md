# Coal-Mine-Drill-Pipe
This paper proposes an improved YOLOX- based method \cite{ge2021yolox} for counting the number of downhole drilling rods.Firstly, the target detection technology enables the positioning of the unit head and the front end of the machine body. Secondly, the spacing is determined by calculating the coordinates of the center point of both prediction boxes and plotting the spacing curves. Finally, small wave crests that have not undergone unloading operations are filtered by establishing the peak threshold. The valid wave crest, which exceeds the specified threshold, is included in the count. Each legitimate wave crest corresponds to a single unloading operation and the unloading of one unloading rod. Therefore, the quantity of valid wave crests is equivalent to the quantity of unloading rods.
The illumination quality in the downhole environment is typically inadequate, and the equipment sensitivities required for capturing downhole images are often set at high levels, making them susceptible to noise interference.Median filtering is generally speaking weaker on sharpness and is a common type of filtering. 
In terms of computational efficiency, the YOLOX model employs a series of optimization strategies, such as feature reuse, adjustable network depth, and convolutional layer fusion, to improve computational efficiency, and compared to general network models, YOLOX has a faster inference speed while maintaining higher detection accuracy.
Initially, image data undergoes enhancement and annotation. Secondly, incorporates an attention mechanism to improve the feature extraction capability. The feature pyramid is utilized to inimize feature loss and facilitate better multi-scale feature fusion. Additionally, the loss function is optimized to enhance the localization ability of the prediction box. The enhanced model  accuracy increase compared to before. 
